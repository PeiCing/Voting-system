<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poll Page</title>
    <link rel="stylesheet" href="style_PollPage.css">
    <script src="PollScript.js" defer></script> <!-- å¼•å…¥ JavaScript æ–‡ä»¶ -->
    <script>
        var response = null; // åœ¨è¿™é‡Œå®šä¹‰ response å˜é‡ï¼Œç¡®ä¿å®ƒæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å€¼

        window.onload = function() {
            updateUIBasedOnSignInStatus();
        };
        
        function updateUIBasedOnSignInStatus() {
            const isSignedOut = sessionStorage.getItem('userSignedOut');
            if (isSignedOut === 'true') {
                // ä½¿ç”¨å­˜å„²çš„å€¼æ›´æ–°ç•Œé¢
                document.getElementById('userPhoto1').src = "pic/username_icon.png";
                document.getElementById('userPhoto2').src = "pic/username_icon.png";
                document.getElementById('userPhoto3').src = "pic/username_icon.png";
                document.getElementById('OnOutLine').textContent = sessionStorage.getItem('outlineStatus') || "ğŸ”´ Outline";
                document.getElementById('SignOut').textContent = "SignIn";
                document.getElementById('SignOut').setAttribute('onclick', 'signInFunction()'); // ç‚ºç™»å…¥æŒ‰éˆ•æ–°å¢é»æ“Šäº‹ä»¶
        
                // å¦‚æœéœ€è¦ï¼Œå¯é‡æ–°æ·»åŠ ç™»å…¥çš„äº‹ä»¶è™•ç†å™¨
                // ä¾‹å¦‚ï¼Œå‡è¨­ signInFunction æ˜¯è™•ç†ç™»å…¥çš„å‡½æ•¸
            }
        }
        document.addEventListener('DOMContentLoaded', function() {
            const togglePassword1 = document.getElementById('togglePassword1');
            const togglePassword2 = document.getElementById('togglePassword2');
            const passwordField = document.getElementById('Password');
            const confirmPasswordField = document.getElementById('confirmPassword');

            togglePassword1.addEventListener('click', function() {
                const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordField.setAttribute('type', type);
                // åˆ‡æ›åœ–ç¤º
                this.src = type === 'password' ? 'pic/eye_closed_icon.png' : 'pic/eye_open_icon.png';
            });

            togglePassword2.addEventListener('click', function() {
                const type = confirmPasswordField.getAttribute('type') === 'password' ? 'text' : 'password';
                confirmPasswordField.setAttribute('type', type);
                // åˆ‡æ›åœ–ç¤º
                this.src = type === 'password' ? 'pic/eye_closed_icon.png' : 'pic/eye_open_icon.png';
            });
        });
    </script>        
</head>
<body>      
    <main>
        <!-- æœ€ä¸Šæ–¹æ·ºè—æ°´å¹³æ¢ -->
        <div class="container-wrapper">
            <a href="HomePage.html"><p>&ensp;&ensp;&ensp;&ensp;&ensp;Voting System</p></a>   
            <img src="pic/List.png" style="height: 20px;position: absolute; left:350px;">             
        </div>
        <!-- æœ€ä¸Šæ–¹æ·ºè—æ°´å¹³æ¢å°¾éƒ¨ä¹‹ä½¿ç”¨è€…å€å¡Š -->
        <div id="ShowUser" class="container-wrapper-user">
            <!-- ä½¿ç”¨è€…ç›¸ç‰‡èˆ‡å§“åï¼Œé»æ“Šè·³å‡ºå°è¦–çª— -->
            <button onclick="ShowUserData()">
                <img src="pic/username_icon.png" id="userPhoto1" alt="User Photo">               
                <p id="usernameDisplay1" style="font-size: 15px;color: #fff;"></p>
                <div id="Block1" style="display: none;">
                    <img src="pic/username_icon.png"  id="userPhoto2" alt="User Photo" style="height: 80px;width: 80px;">
                    <p id="usernameDisplay2" style="font-size: 15px;color: #fff;"></p>
                </div>
            </button>
        </div>
        <div id="Block2" style="display: none;" >
            <button  id="Update" onclick="openModal()" style="position: absolute;left: 25px;top:15px;font-size: 15px;">
                Update
            </button>
            <button id="SignOut" onclick="SignOut()" style="position: absolute;right: 25px;top:15px;font-size: 15px;">
                SignOut
            </button>
        </div>
        <!-- Update è¦–çª— -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <!-- X  æŒ‰é’® -->
                <span class="close" onclick="closeModal('myModal')">&times;</span>
                <!-- Close æŒ‰é’® -->
                <button class="close" id="CloseBTN" onclick="closeModal('myModal')"> X Close</button>
                <!-- Save æŒ‰é’® -->
                <button class="close" id="SaveBTN" onclick="saveChanges(event)"> V Save </button>

                <!-- æ¨™é¡Œ -->
                <p  style="font-size: 25px;"><b>&ensp; Users Profile</b></p>

                <div style="border: 1px solid #ccc;"></div> <!-- æ°´å¹³æ©«ç·š -->
                <!-- è¼¸å…¥ä½¿ç”¨è€…åç¨±æ¬„ä½ -->
                <div class="input-container">
                    <p><b>&ensp;&ensp; Usernames:</b></p>
                    <input type="text" placeholder="NewUsername" class="input-field"> 
                </div>
                <!-- è¼¸å…¥å¯†ç¢¼æ¬„ä½ -->
                <div class="input-container">
                    <p><b>&ensp;&ensp; Password:</b></p>
                    <input type="password" placeholder="NewPassword" id="Password" class="input-field"> 
                    <img src="pic/eye_closed_icon.png"  style="margin-right: 10%;height: 25px;" alt="Eye Icon" id="togglePassword1"> <!-- æ’å…¥çœ¼ç›åœ–ç¤º -->       
                </div>
                <!-- ä¸Šå‚³æª”æ¡ˆæ¬„ä½ -->
                <form id="profileForm" enctype="multipart/form-data">
                    <div class="input-container">
                        <p><b>&ensp;&ensp; Photos:</b></p>
                        <input type="file" placeholder="NewPhoto" id="fileInput" class="input-field"> 
                    </div>
                </form>

                <div style="border: 1px solid #ccc;"></div> <!-- æ°´å¹³æ©«ç·š -->
                <!-- è¼¸å…¥ç›®å‰å¯†ç¢¼ç¢ºèªä¿®æ”¹ -->
                <div class="input-container">
                    <p><b>&ensp;&ensp; Current Password:</b></p>
                    <input type="password" placeholder="CurrentPassword" id="confirmPassword" class="input-field"> 
                    <img src="pic/eye_closed_icon.png"  style="margin-right: 10%;height: 25px;" alt="Eye Icon" id="togglePassword2"> <!-- æ’å…¥çœ¼ç›åœ–ç¤º -->       
                </div>

                <div style="border: 1px solid #ccc;"></div> <!-- æ°´å¹³æ©«ç·š -->
                
                <!-- éŒ¯èª¤æç¤º -->
                <div id="error-container" class="error-message" style="margin-top: 100px;display: none;"><br></div>
            </div>
        </div> 
        <!-- -------------------------------------------------------------------------------  -->
        <!-- æœ€å·¦å´å€å¡Š -->   
        <div class="user-info">
            <!-- ä½¿ç”¨è€…ç›¸ç‰‡ -->
            <img src="pic/username_icon.png" id="userPhoto3" alt="User Photo" class="user_img">
            <!-- ä½¿ç”¨è€…åç¨±+åœ¨ç·šæç¤º -->
            <p id="usernameDisplay3"><br></p><p id="OnOutLine" style="font-size: 15px;top:50px;">ğŸŸ¢ Online </p>
        </div>
        <div class="List-Title">
            <!-- åˆ—è¡¨Title -->
            <p>&ensp;<b>MANAGE</b></p>
        </div>

        <div class="List_Option">
            <!-- é¸é …1:Home -->
            <div>
                <button onclick="redirectToHomePage('HomePage')">
                    <img src="pic/home.png" style="position: absolute;height: 30px;right:240px;" alt="HomePage"> <!-- åœ–ç‰‡ -->
                    <b>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Home</b>
                </button>
            </div>
            <!-- é¸é …2:Poll page -->
            <div style="position: absolute; top: 50px;">
                <button onclick="redirectToHomePage('PollPage')">
                    <img src="pic/line.png" style="position: absolute; right:290px;height: 50px; " alt="">
                    <img src="pic/poll.png" style="position: absolute;height: 30px;right:240px;" alt="PollPage"> <!-- åœ–ç‰‡ -->
                    <b>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;Poll page</b>
                </button>
            </div>
        </div>
        <!-- -------------------------------------------------------------------------------  -->
        <div class="Home_Content">
            <h1> &ensp;&ensp; Topic and Titles </h1>
            <div class="Content_Title">

                <button id="New" onclick="openPollModal()">
                    <b>&ensp;+ New</b>
                </button>

                <p>
                    &ensp;&ensp;Show
                    <select id="entriesSelect">
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                    </select>
                    entries
                    &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                    Search:
                    <input type="text" id="searchInput" placeholder="Search..." oninput="searchTopics(response)">
                </p> 
            </div>

            <div class="Content_List">
                <table>
                    <thead>
                        <tr>
                            <th>
                                <p>Topics <button onclick="ClickSort(this)" style="background: transparent; border: none;"><img src="pic/sort.png" style="height: 15px;"></button></p>
                            </th>
                            <th>
                                <p>Titles <button onclick="ClickSort(this)" style="background: transparent; border: none;"><img src="pic/sort.png" style="height: 15px;"></button></p>
                            </th>
                            <th>
                                <p>Created Time <button onclick="ClickSort(this)" style="background: transparent; border: none;"><img src="pic/sort.png" style="height: 15px;"></button></p>
                            </th>
                            <th>
                                <p>Tools <button onclick="ClickSort(this)" style="background: transparent; border: none;"><img src="pic/sort.png" style="height: 15px;"></button></p>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            
                        </tr>
                    </tbody>
                    <!-- æ·»åŠ æ›´å¤šè¡Œ -->

                </table>
                <div style="display: flex; justify-content: flex-end;">
                    <p style="margin: 0 10px; font-size: 15px;">&nbsp;Showing&nbsp;</p>
                    <button id="Previous">Previous</button>
                    <span  id="Page" style="margin: 0 10px; font-size: 15px;">&nbsp;1&nbsp;</span>
                    <button id="Next">Next</button>
                </div>
            </div>
        </div>

        <!-- æ–°å¢æŠ•ç¥¨æ¡†--> 
        <!-- NewPoll è¦–çª— -->
         <div id="PollModal" class="Pollmodal">
            <div class="pollmodal-content">
                <!-- X  æŒ‰é’® -->
                <span class="close" onclick="closeModal('PollModal')">&times;</span>
                <!-- Close æŒ‰é’® -->
                <button class="close" id="CloseBTN" style="right: 120px;border-radius: 10px;" onclick="closeModal('PollModal')"> X Close</button>
                <!-- Save æŒ‰é’® -->
                <button class="close" id="SaveBTN" style="right: 30px;border-radius: 10px;" onclick="savePollChanges(event)"> V Save </button>

                <!-- æ¨™é¡Œ -->
                <p  style="font-size: 25px;"><b>&ensp; Add New Topics</b></p>

                <div style="border: 1px solid #ccc;"></div> <!-- æ°´å¹³æ©«ç·š -->

               <!-- Topicsæ¬„ä½ä¸‹æ‹‰å¼é¸å–®åŒ…å«(å‹•ç•«èˆ‡æ¼«ç•«ã€åäººèˆ‡é›»å½±ã€ç§‘æŠ€å‰µæ–°ã€é‡‘èæŠ•è³‡) -->
                <div class="input-container">
                    <p><b>&ensp;&ensp; Topics:</b></p>
                    <div style="display: flex; align-items: center;">
                        <select id="topicSelect" class="input-field" style="margin-right: 5px;">
                            <option value="Select existing">Select existing</option>
                            <option value="å‹•ç•«èˆ‡æ¼«ç•«">å‹•ç•«èˆ‡æ¼«ç•«</option>
                            <option value="åäººèˆ‡é›»å½±">åäººèˆ‡é›»å½±</option>
                            <option value="ç§‘æŠ€å‰µæ–°">ç§‘æŠ€å‰µæ–°</option>
                            <option value="é‡‘èæŠ•è³‡">é‡‘èæŠ•è³‡</option>
                        </select>
                        <input type="text" placeholder="Enter new title" id="newTopicInput" class="input-field"> 
                    </div>
                </div>
                <!-- è¼¸å…¥Titlesæ¬„ä½ä¸‹æ‹‰å¼é¸å–®åŒ…å«(å¥½è½ã€å¥½çœ‹ã€å°ˆæ¥­ã€ç™¼å¤§è²¡) -->
                <div class="input-container">
                    <p><b>&ensp;&ensp; Titles:</b></p>
                    <div style="display: flex; align-items: center;">
                        <select id="titleSelect" class="input-field" style="margin-right: 5px;">
                            <option value="Select existing">Select existing</option>
                            <option value="å¥½è½">å¥½è½</option>
                            <option value="å¥½çœ‹">å¥½çœ‹</option>
                            <option value="å°ˆæ¥­">å°ˆæ¥­</option>
                            <option value="ç™¼å¤§è²¡">ç™¼å¤§è²¡</option>
                        </select>
                        <input type="text" placeholder="Enter new title" id="newTitleInput" class="input-field"> 
                    </div>
                </div>
                <!-- enter a new Option or Add options and enter new Options -->
                <div class="input-container" id="optionsContainer">
                    <p><b>&ensp;&ensp; Options:</b></p>
                    <div id="optionInputs">
                        <input type="text" placeholder="NewOptions" class="input-field">
                        <br>
                    </div>
                    <button type="button" onclick="addOption()" class="add-options-btn">Add<br>options</button>
                </div>

                <div style="border: 1px solid #ccc;"></div> <!-- æ°´å¹³æ©«ç·š -->
                
                
            </div>    
            <!-- éŒ¯èª¤æç¤º -->
            <div id="save_error-container" class="error-message" style="margin-left: 550px;display: none;"><br></div>        
         </div>        
        <!-- -------------------------------------------------------------------------------  --> 
        <!-- EditPoll è¦–çª— -->
        <div id="EditPollModal" class="Pollmodal">
            <div class="pollmodal-content">
                <!-- X  æŒ‰é’® -->
                <span class="close" onclick="closeModal('EditPollModal')">&times;</span>
                <!-- Close æŒ‰é’® -->
                <button class="close" id="CloseBTN" style="right: 120px;border-radius: 10px;" onclick="closeModal('EditPollModal')"> X Close</button>
                <!-- Save æŒ‰é’® -->
                <button class="close" id="SaveBTN" style="right: 30px;border-radius: 10px;" onclick="saveEditChanges(event)"> V Save </button>

                <!-- æ¨™é¡Œ -->
                <p  style="font-size: 25px;"><b>&ensp; Add New Topics</b></p>

                <div style="border: 1px solid #ccc;"></div> <!-- æ°´å¹³æ©«ç·š -->

               <!-- Topicsæ¬„ä½ä¸‹æ‹‰å¼é¸å–®åŒ…å«(å‹•ç•«èˆ‡æ¼«ç•«ã€åäººèˆ‡é›»å½±ã€ç§‘æŠ€å‰µæ–°ã€é‡‘èæŠ•è³‡) -->
                <div class="input-container">
                    <p><b>&ensp;&ensp; Topics:</b></p>
                    <div style="display: flex; align-items: center;">
                        <select id="EdittopicSelect" class="input-field" style="margin-right: 5px;">
                            <option value="Select existing">Select existing</option>
                            <option value="å‹•ç•«èˆ‡æ¼«ç•«">å‹•ç•«èˆ‡æ¼«ç•«</option>
                            <option value="åäººèˆ‡é›»å½±">åäººèˆ‡é›»å½±</option>
                            <option value="ç§‘æŠ€å‰µæ–°">ç§‘æŠ€å‰µæ–°</option>
                            <option value="é‡‘èæŠ•è³‡">é‡‘èæŠ•è³‡</option>
                        </select>
                        <input type="text" placeholder="Enter new title" id="EditTopicInput" class="input-field"> 
                    </div>
                </div>
                <!-- è¼¸å…¥Titlesæ¬„ä½ä¸‹æ‹‰å¼é¸å–®åŒ…å«(å¥½è½ã€å¥½çœ‹ã€å°ˆæ¥­ã€ç™¼å¤§è²¡) -->
                <div class="input-container">
                    <p><b>&ensp;&ensp; Titles:</b></p>
                    <div style="display: flex; align-items: center;">
                        <select id="EdittitleSelect" class="input-field" style="margin-right: 5px;">
                            <option value="Select existing">Select existing</option>
                            <option value="å¥½è½">å¥½è½</option>
                            <option value="å¥½çœ‹">å¥½çœ‹</option>
                            <option value="å°ˆæ¥­">å°ˆæ¥­</option>
                            <option value="ç™¼å¤§è²¡">ç™¼å¤§è²¡</option>
                        </select>
                        <input type="text" placeholder="Enter new title" id="EditTitleInput" class="input-field"> 
                    </div>
                </div>
                <!-- enter a new Option or Add options and enter new Options -->
                <div class="input-container" id="optionsContainer">
                    <p><b>&ensp;&ensp; Options: &ensp;&ensp; </b></p>
                    <div id="EditoptionInputs">
                        <input type="text" placeholder="NewOptions" class="input-field">
                        <br>
                    </div>
                    <button type="button" onclick="addOption_Edit()" class="add-options-btn">Add<br>options</button>
                </div>

                <div style="border: 1px solid #ccc;"></div> <!-- æ°´å¹³æ©«ç·š -->
                
                <!-- éŒ¯èª¤æç¤º -->
                <div id="save_Edit_error-container" class="error-message" style="margin-top: 100px;display: none;"><br></div>
            </div>            
         </div>        
    </main>
</body>
</html>
